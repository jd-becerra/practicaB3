(()=>{"use strict";var i={606:function(i,e){var n=this&&this.__awaiter||function(i,e,n,t){return new(n||(n=Promise))((function(o,r){function d(i){try{g(t.next(i))}catch(i){r(i)}}function s(i){try{g(t.throw(i))}catch(i){r(i)}}function g(i){var e;i.done?o(i.value):(e=i.value,e instanceof n?e:new n((function(i){i(e)}))).then(d,s)}g((t=t.apply(i,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.isDebugModeOn=e.UidSecureSignalProvider=void 0,e.UidSecureSignalProvider=class{constructor(i=!1,e=!1){this.registerSecureSignalProvider=()=>{const i=this.retrieveAdvertisingTokenHandler();i?(window.googletag=window.googletag||{cmd:[]},window.googletag.secureSignalProviders=window.googletag.secureSignalProviders||[],window.googletag.secureSignalProviders.push({id:this.isEuid?"euid.eu":"uidapi.com",collectorFunction:()=>n(this,void 0,void 0,(function*(){this.logging("collectorFunction invoked");const e=yield this.getUidAdvertisingTokenWithRetry(i);return this.logging(`collectorFunction pushes: ${e}`),e}))})):console.warn("UidSecureSignal: Please implement `getUidAdvertisingToken`")},this.logging=i=>{this.debug&&console.log(`UidSecureSignal: ${i}`)},this.retrieveAdvertisingTokenHandler=()=>{if(this.isEuid){if("function"==typeof window.getEuidAdvertisingToken)return window.getEuidAdvertisingToken;if(window.__euid&&"getAdvertisingTokenAsync"in window.__euid)return window.__euid.getAdvertisingTokenAsync.bind(window.__euid)}else{if("function"==typeof window.getUid2AdvertisingToken)return window.getUid2AdvertisingToken;if(window.__uid2&&"getAdvertisingTokenAsync"in window.__uid2)return window.__uid2.getAdvertisingTokenAsync.bind(window.__uid2)}},this.getUidAdvertisingTokenWithRetry=(i,e=3)=>{let t=this;return new Promise(((o,r)=>n(this,void 0,void 0,(function*(){let d=0;!function s(g){return n(this,void 0,void 0,(function*(){var n;if(d>=e)return null===(n=window.__uid2SecureSignalProvider)||void 0===n||n.logging(`getUidAdvertisingTokenWithRetry failed with error after retry: ${g}`),void r(g);d++;try{const e=yield i();t.logging(`getUidAdvertisingTokenWithRetry resolved with: ${e}`),o(e)}catch(i){t.logging(`getUidAdvertisingTokenWithRetry failed with error: ${i}`),s(i)}}))}()}))))},this.debug=i,this.isEuid=e,(!this.isEuid&&"function"==typeof window.getUid2AdvertisingToken||this.isEuid&&"function"==typeof window.getEuidAdvertisingToken)&&(this.logging("register SecureSignalProvider"),this.registerSecureSignalProvider())}},e.isDebugModeOn=function(i){var e;const n=new URLSearchParams(window.location.search).get("uid2_ss_debug");return"TRUE"===(null==n?void 0:n.toLocaleUpperCase())||(null===(e=document.currentScript)||void 0===e?void 0:e.src.startsWith(i))}}},e={};function n(t){var o=e[t];if(void 0!==o)return o.exports;var r=e[t]={exports:{}};return i[t].call(r.exports,r,r.exports,n),r.exports}(()=>{const i=n(606);var e;window.__uid2SecureSignalProvider=new i.UidSecureSignalProvider((0,i.isDebugModeOn)("https://cdn.integ.uidapi.com/")),window.__uid2=window.__uid2||{callbacks:[]},null===(e=window.__uid2.callbacks)||void 0===e||e.push((i=>{"SdkLoaded"===i&&window.__uid2SecureSignalProvider.registerSecureSignalProvider()}))})()})();